

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; predictatops 0.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> predictatops
          

          
            
            <img src="_static/Yale-Peabody-Triceratops-004Trp.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Readme File</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-high-level-description-of-code-project-architecture">Quick High-level Description of Code Project Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-pipeline">A pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modules-that-hold-functions-vs-modules-that-will-execute-code">Modules that hold functions vs. modules that will execute code.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-pipeline-using-only-high-level-runner-modules">Running the Pipeline Using Only High-Level “_runner” Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-install-predictatops-and-run-the-demo-dataset-straight-through-in-shortest-way-possibe">How install predictatops and run the demo dataset straight through in shortest way possibe:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#in-a-terminal-type-the-following-commands">In a terminal type the following commands -</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-this-runs">What this runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#changing-how-it-runs-via-configuration-instructions">Changing how it runs via configuration instructions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#more-complicated-ways-to-run">More complicated ways to run</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-with-more-control-or-different-code-swapped-in">Running with more control or different code swapped in</a></li>
<li class="toctree-l2"><a class="reference internal" href="#demo-notebooks">Demo notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#if-you-use-your-own-dataset-some-code-features-you-might-need-to-change">If you use your own dataset, some code features you might need to change</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions_and_classes.html">functions and classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">predictatops</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quick-high-level-description-of-code-project-architecture">
<h2>Quick High-level Description of Code Project Architecture<a class="headerlink" href="#quick-high-level-description-of-code-project-architecture" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-pipeline">
<h3>A pipeline<a class="headerlink" href="#a-pipeline" title="Permalink to this headline">¶</a></h3>
<p>Predictatops is a pipeline. It consists of a series of steps.</p>
<p>The steps include things like fetch the demo data, load data, train, etc.</p>
<p>The code for each step was written with the assumption that people, including the authors,
would want to throw out parts and substitute in new or different code while keeping the
other code the same. It was also written with the idea that sometimes you’d want to just
call an entire step via a single command and other times you’d want to call things incrementally
sub-step by sub-step.</p>
</div>
<div class="section" id="modules-that-hold-functions-vs-modules-that-will-execute-code">
<h3>Modules that hold functions vs. modules that will execute code.<a class="headerlink" href="#modules-that-hold-functions-vs-modules-that-will-execute-code" title="Permalink to this headline">¶</a></h3>
<p>If you look at the modules in Predicatops, you’ll noticed there are pairs of modules where one member
of a pair has the same name but ‘_runner’ affixed to its end, for example load.py &amp; load_runner.py.
Load.py contains only functions and class definitions. It doesn’t execute any code by itself.
load_runner.py calls functions and classes from load.py and then executes them. Any Python module
with ‘_runner’ on the end is basically a single module you can call to run all the functions in the
module without ‘_runner’ on the end.</p>
</div>
<div class="section" id="running-the-pipeline-using-only-high-level-runner-modules">
<h3>Running the Pipeline Using Only High-Level “_runner” Modules<a class="headerlink" href="#running-the-pipeline-using-only-high-level-runner-modules" title="Permalink to this headline">¶</a></h3>
<p>You can combine all the ‘_runner.py’ modules one after another to run through the whole Predictatops
sequence quite simply. The major modules necessary to run the Predicatops pipline are listed below.
These are called in the same sequence below in the all_runner.py module.</p>
<ul class="simple">
<li><p><em>fetch_demo_data.py</em> = fetches demo dataset for predicting top Mcmurray.</p></li>
<li><p><em>configurationplusfiles_runner.py</em> = establishes configuration, input data, &amp; output variables.</p></li>
<li><p><em>checkdata_runner.py</em> = finds what curves &amp; tops are available for use in the input dataset.</p></li>
<li><p><em>load_runner.py</em> = loads the well curves and tops.</p></li>
<li><p><em>split_runner.py</em> = splits the wells into train &amp; test portions.</p></li>
<li><p><em>wellsKNN_runner.py</em> = finds the nearest neighbors of each well and creates some features.</p></li>
<li><p><em>features_runner.py</em> = creates the rest of the features.</p></li>
<li><p><em>balance_runner.py</em> = throws away instances of common classes &amp; duplicates uncommon classes.</p></li>
<li><p><em>trainclasses_runner.py</em> = trains the dataset using XGBoost algorithm.</p></li>
<li><p><em>predictionclasses_runner.py</em> = uses the trained model to predict stratigraphic tops.</p></li>
</ul>
<p>The ‘_runner’ modules know how to execute the modules without ‘_runner’ based on a combination
of sensible defaults defined in the ‘_runner’ files &amp; choices established in the
configurationplusfiles_runner.py module.</p>
<div class="section" id="how-install-predictatops-and-run-the-demo-dataset-straight-through-in-shortest-way-possibe">
<h4>How install predictatops and run the demo dataset straight through in shortest way possibe:<a class="headerlink" href="#how-install-predictatops-and-run-the-demo-dataset-straight-through-in-shortest-way-possibe" title="Permalink to this headline">¶</a></h4>
<p>This uses Conda, so you might have to install that first.</p>
</div>
</div>
</div>
<div class="section" id="in-a-terminal-type-the-following-commands">
<h2>In a terminal type the following commands -<a class="headerlink" href="#in-a-terminal-type-the-following-commands" title="Permalink to this headline">¶</a></h2>
<p>Note: These first steps are duplicated here from the installation section:
Clone the predictatops repository first as we don’t have have it PyPy yet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">JustinGOSSES</span><span class="o">/</span><span class="n">predictatops</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>CD into the the folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">predictatops</span>
</pre></div>
</div>
<p>Create the conda environment with all the dependencies from the environment.yml at the top level folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">environment</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>Activate that conda environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="n">activate</span> <span class="n">predictatops</span>
</pre></div>
</div>
<p>Now we’re into the actual usuage part.</p>
<p>Change directories to the predictatops source folder inside of the top-level Predictatops:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">predictatops</span>
</pre></div>
</div>
<p>Run the script to fetch the demo data and put it in the data folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Python</span> <span class="n">fetch_demo_data</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run the all_runner script to run all the code in one go:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Python</span> <span class="n">all_runner</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="what-this-runs">
<h2>What this runs<a class="headerlink" href="#what-this-runs" title="Permalink to this headline">¶</a></h2>
<p>This will run all the code using the demo dataset and default configuration, which predicts the top McMurray surface. It takes about 1.5 hours on a 2015 MacBook Pro.</p>
</div>
<div class="section" id="changing-how-it-runs-via-configuration-instructions">
<h2>Changing how it runs via configuration instructions<a class="headerlink" href="#changing-how-it-runs-via-configuration-instructions" title="Permalink to this headline">¶</a></h2>
<p>Results should be in the results folder or whatever output folder is set as the base output folder via configurationplusfiles.py
This method of running assumes you’re using all the default input, configuration, and output settings for the demo dataset. If you aren’t interested in that, you’ll need to change those via the configurationplusfiles.py file.</p>
</div>
</div>
<div class="section" id="more-complicated-ways-to-run">
<h1>More complicated ways to run<a class="headerlink" href="#more-complicated-ways-to-run" title="Permalink to this headline">¶</a></h1>
<p>There are three ways to run the code all the way through at three different levels of abstraction.</p>
<p>(1.) You can run one python script that does everything based on configuration. This is the all_runner.py used above.</p>
<p>(2.) You can call each major step via a python file, examples of how to do that have _runner on the end, like load_runner.py or features_runner.py.</p>
<p>(3.) You can also import functions from the python file for each step and call them from within your own code.</p>
<div class="section" id="running-with-more-control-or-different-code-swapped-in">
<h2>Running with more control or different code swapped in<a class="headerlink" href="#running-with-more-control-or-different-code-swapped-in" title="Permalink to this headline">¶</a></h2>
<p>If you want the most control, you can import the functions in the python files for each of those major steps and call those functions within your own code. This is method 3 above. This will let you more easily swap in and out new parts and interrogate itermediate results. Notebooks below give some examples on how to do this.</p>
<p>Note: these jupyter notebooks are still in progress.</p>
</div>
<div class="section" id="demo-notebooks">
<h2>Demo notebooks<a class="headerlink" href="#demo-notebooks" title="Permalink to this headline">¶</a></h2>
<p>0. The notebook <a class="reference external" href="https://github.com/JustinGOSSES/predictatops/blob/master/demo/Example_Every_Step_Via_HighLevel_Runner_Scripts_v1.ipynb">Example_Every_Step_Via_HighLevel_Runner_Scripts_v1.ipynb</a>. covers:
Running the high-level runner modules for each step one by one. This does the whole pipeline from data load, data evaluation, data processing, feature creation, model training, to prediction.
- fetch_demo_data.py</p>
<ul class="simple">
<li><p>configurationplusfiles_runner.py</p></li>
<li><p>checkdata_runner.py</p></li>
<li><p>load_runner.py</p></li>
<li><p>split_runner.py</p></li>
<li><p>wellsKNN_runner.py</p></li>
<li><p>features_runner.py</p></li>
<li><p>balance_runner.py</p></li>
<li><p>trainclasses_runner.py</p></li>
<li><p>predictionclasses_runner.py</p></li>
</ul>
<p>1. The notebook <a class="reference external" href="https://github.com/JustinGOSSES/predictatops/blob/master/demo/Example_firstSteps_modules_fetchdata_configuration_checkdata.ipynb/">Example_firstSteps_modules_fetchdata_configuration_checkdata.ipynb</a>. Covers the initial data load, data evaluation, and configuration. Specifically it covers the modules:</p>
<ul class="simple">
<li><dl class="simple">
<dt>fetch_demo_data.py</dt><dd><ul>
<li><p>Gets the data into the data folder from the demo folder in the repository.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>configurationplusfiles.py</dt><dd><ul>
<li><p>Instantiates the class objects that contain information on how to run the rest of the program as it applies to input files, output files, and general configuration.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>checkdata.py</dt><dd><ul>
<li><p>Helps to find out which wells have the tops and curves you need or the inverse to find out which curves you have if you want a certain number of wells in your data population.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<ol class="arabic simple" start="2">
<li><p>The notebook TBD</p></li>
</ol>
<ul class="simple">
<li><dl class="simple">
<dt>load.py</dt><dd><ul>
<li><p>Loads the data from wells identified in the checkdata.py step above.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>split.py</dt><dd><ul>
<li><p>Splits the data from the load.py step into train and test groups.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<ol class="arabic simple" start="3">
<li><p>The notebook TBD</p></li>
</ol>
<ul class="simple">
<li><dl class="simple">
<dt>wellsKNN.py</dt><dd><ul>
<li><p>Uses well location to identify wells next to one another up to X number of neighbors.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>4. The notebook <a class="reference external" href="https://github.com/JustinGOSSES/predictatops/blob/master/demo/Example_module_balance_v1.ipynb/">Example_module_balance_v1.ipynb</a>.  covers:</p>
<ul class="simple">
<li><dl class="simple">
<dt>balance.py</dt><dd><ul>
<li><p>balancing the populations of classes, or labels, associated with each depth point in each well for training, so there are roughly equal number of classes.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>5. The notebook <a class="reference external" href="https://github.com/JustinGOSSES/predictatops/blob/master/demo/Example_module_features_and_balance.ipynb/">Example_module_features_and_balance.ipynb</a>. covers:</p>
<ul class="simple">
<li><dl class="simple">
<dt>features.py</dt><dd><ul>
<li><p>creates features not already created in wellsKNN.py</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>balance.py</dt><dd><ul>
<li><p>balancing the populations of classes, or labels, associated with each depth point in each well for training, so there are roughly equal number of classes.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>6. The notebook <a class="reference external" href="https://github.com/JustinGOSSES/predictatops/blob/master/demo/Example_module_trainclasses_v2.ipynb/">Example_module_trainclasses_v2.ipynb</a>.  covers:</p>
<ul class="simple">
<li><dl class="simple">
<dt>trainclasses.py</dt><dd><ul>
<li><p>training the model</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>7. The notebook <a class="reference external" href="https://github.com/JustinGOSSES/predictatops/blob/master/demo/Example_module_predictionclasses_v1.ipynb/">Example_module_predictionclasses_v1.ipynb</a>.  covers:</p>
<ul class="simple">
<li><dl class="simple">
<dt>predictionclasses.py</dt><dd><ul>
<li><p>making the top prediction</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="if-you-use-your-own-dataset-some-code-features-you-might-need-to-change">
<h1>If you use your own dataset, some code features you might need to change<a class="headerlink" href="#if-you-use-your-own-dataset-some-code-features-you-might-need-to-change" title="Permalink to this headline">¶</a></h1>
<p>This code assumes all wells to be in the same file format, LAS.</p>
<p>The load_all_wells_in() function in load.py does a slight transformation to the UWI names as the UWI uses / in places and - in others. Please look at this function and your datasets to figure out if it applies to your data. You may need to modify this piece of code for your own purposes.</p>
<p>There is an assumption that the picks text file includes a quality column. If there isn’t, fake one with everything as equally quality at value of 1.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Justin Gosses

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>